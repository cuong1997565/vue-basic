{"remainingRequest":"/var/www/javascript/vuejs/vue-cnd/vue-router/node_modules/vue-loader/lib/index.js??vue-loader-options!/var/www/javascript/vuejs/vue-cnd/vue-router/src/views/CreateArticle.vue?vue&type=script&lang=js&","dependencies":[{"path":"/var/www/javascript/vuejs/vue-cnd/vue-router/src/views/CreateArticle.vue","mtime":1564455149993},{"path":"/var/www/javascript/vuejs/vue-cnd/vue-router/node_modules/cache-loader/dist/cjs.js","mtime":1564127716179},{"path":"/var/www/javascript/vuejs/vue-cnd/vue-router/node_modules/babel-loader/lib/index.js","mtime":1564127721155},{"path":"/var/www/javascript/vuejs/vue-cnd/vue-router/node_modules/cache-loader/dist/cjs.js","mtime":1564127716179},{"path":"/var/www/javascript/vuejs/vue-cnd/vue-router/node_modules/vue-loader/lib/index.js","mtime":1564127714399}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport PictureInput from 'vue-picture-input';\nimport axios from 'axios';\nimport config from '@/config';\nexport default {\n    beforeRouteEnter(to, from, next) {\n        if(!localStorage.getItem(\"auth\")) {\n            return next({path : \"/login\"});\n        }\n        next();\n    },\n    data() {\n        return {\n            title : \"\",\n            content : \"\",\n            image : null,\n            categories : [],\n            category : \"\",\n            loading : false\n        }\n    },\n    components : {\n        PictureInput\n    },\n    mounted() {\n          this.getCategories();\n    },\n    methods : {\n        onChange(image) {\n            this.image = image;\n        },\n        createArticle() {\n            this.loading = true;\n            const form = new FormData();\n            form.append('file', this.image);\n            form.append('upload_preset','g5ziunzg');\n            form.append('api_key','132255634713478');\n            axios.post('https://api.cloudinary.com/v1_1/bahdcoder/image/upload',form)\n            .then((res) => {\n                this.loading = false;\n                 this.submitForm(res);\n            })\n            .catch(err => {\n                this.loading = false;\n                this.$noty.error(\"Image upload false\")\n            })\n\n        },\n\n        submitForm(response) {\n            axios.post(`${config.apiUrl}/articles`, {\n                title : this.title,\n                content : this.content,\n                category_id : this.category,\n                imageUrl : response.data.secure_url\n            },{\n                headers : {\n                    Authorization : `Bearer ${this.$root.auth.token}`\n                }\n            }).then(() => {\n                this.loading = false;\n                this.$noty.success(\"Article created successfully.\");\n                this.$router.push(\"/home\");\n            }).catch(() => {\n                this.loading = false;\n                this.$noty.error(\"Oops ! Something went wrong\");\n            })\n        },\n\n        getCategories() {\n            const categories = localStorage.getItem(\"categories\");\n            if(categories) {\n                this.categories = JSON.parse(categories);\n                return ;\n            }\n            axios.get(`${config.apiUrl}/categories`).then(res => {\n                this.categories = res.data.categories;\n                localStorage.setItem(\"categories\", JSON.stringify(this.categories));\n            })\n        }\n    }\n}\n",{"version":3,"sources":["CreateArticle.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CreateArticle.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <div class=\"container\">\n        <div class=\"row\">\n            <div class=\"col-md-8 offset-md-2\">\n                <div class=\"card my-5\">\n                    <div class=\"card-body\">\n                        <picture-input \n                        accept = \"image/jpeg,image/png\"\n                        size=\"5\"\n                        button-class=\"btn btn-danger\"\n                        :custom-strings = \"{\n                            upload : '<h1>Bummer!</h1>',\n                            drag : 'Drag a GIF or GTFO'\n                        }\"\n                        @change=\"onChange\"\n                        />\n                        <select class=\"form-control mt-3\" v-model=\"category\">\n                            <option selected>Select a category</option>\n                            <option :value=\"category.id\" :key=\"category.id\" v-for=\"category in categories\">\n                                {{ category.name }}\n                            </option>\n                        </select>\n                        <input type=\"text\" v-model=\"title\" placeholder=\"title\" class=\"form-control mb-3 mt-3\">\n                        <wysiwyg v-model=\"content\" />\n                        <div class=\"text-center\">\n                            <button @click=\"createArticle()\" class=\"btn-success btn btn-lg mt-3\">Create Article</button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n<script>\nimport PictureInput from 'vue-picture-input';\nimport axios from 'axios';\nimport config from '@/config';\nexport default {\n    beforeRouteEnter(to, from, next) {\n        if(!localStorage.getItem(\"auth\")) {\n            return next({path : \"/login\"});\n        }\n        next();\n    },\n    data() {\n        return {\n            title : \"\",\n            content : \"\",\n            image : null,\n            categories : [],\n            category : \"\",\n            loading : false\n        }\n    },\n    components : {\n        PictureInput\n    },\n    mounted() {\n          this.getCategories();\n    },\n    methods : {\n        onChange(image) {\n            this.image = image;\n        },\n        createArticle() {\n            this.loading = true;\n            const form = new FormData();\n            form.append('file', this.image);\n            form.append('upload_preset','g5ziunzg');\n            form.append('api_key','132255634713478');\n            axios.post('https://api.cloudinary.com/v1_1/bahdcoder/image/upload',form)\n            .then((res) => {\n                this.loading = false;\n                 this.submitForm(res);\n            })\n            .catch(err => {\n                this.loading = false;\n                this.$noty.error(\"Image upload false\")\n            })\n\n        },\n\n        submitForm(response) {\n            axios.post(`${config.apiUrl}/articles`, {\n                title : this.title,\n                content : this.content,\n                category_id : this.category,\n                imageUrl : response.data.secure_url\n            },{\n                headers : {\n                    Authorization : `Bearer ${this.$root.auth.token}`\n                }\n            }).then(() => {\n                this.loading = false;\n                this.$noty.success(\"Article created successfully.\");\n                this.$router.push(\"/home\");\n            }).catch(() => {\n                this.loading = false;\n                this.$noty.error(\"Oops ! Something went wrong\");\n            })\n        },\n\n        getCategories() {\n            const categories = localStorage.getItem(\"categories\");\n            if(categories) {\n                this.categories = JSON.parse(categories);\n                return ;\n            }\n            axios.get(`${config.apiUrl}/categories`).then(res => {\n                this.categories = res.data.categories;\n                localStorage.setItem(\"categories\", JSON.stringify(this.categories));\n            })\n        }\n    }\n}\n</script>\n"]}]}